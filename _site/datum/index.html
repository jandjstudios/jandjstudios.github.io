<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.12.0 by Michael Rose
  Copyright 2013-2018 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>datum - J&amp;J Studios</title>
<meta name="description" content="Detailed information about the datum product line.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="J&J Studios">
<meta property="og:title" content="datum">
<meta property="og:url" content="http://localhost:4000/datum/">


  <meta property="og:description" content="Detailed information about the datum product line.">







  <meta property="article:published_time" content="2019-06-13T17:21:13-07:00">



  <meta property="article:modified_time" content="2018-06-04T09:04:24-07:00">



  

  


<link rel="canonical" href="http://localhost:4000/datum/">







  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "J&J Studios",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="J&J Studios Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/"><img src="/assets/images/J&J Studios LLC Logo-1211x1211.png" width=75 height=75></a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item">
              <a href="/home/" >home</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="/blog/" >blog</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="/products/" >products</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="/datum/" >datum</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="/about/" >about</a>
            </li>
          
        </ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
        <img src=
        
          "/assets/images/datumLogo.png"
        
        alt="datumLogo">
      
      
      
    
    
  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="datum">
    <meta itemprop="description" content="Detailed information about the datum product line.">
    
    <meta itemprop="dateModified" content="June 04, 2018">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">datum
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <ol>
  <li>a piece of information</li>
  <li>a fixed starting point of a scale or operation</li>
</ol>

<hr />
<p>The goal of this project is to make it easier for students and hobbyists to incorporate sensors into their projects by doing the heavy lifting of translating the language the sensors speak into a format that’s easy for humans to read and for machines to parse and process.</p>

<p>Towards that end each datum board emulates a serial port over a USB connection, presents the information and data stored on them in a JSON encapsulated packet, and processes URI style commands to change and retrieve their settings.  The datum boards fill the gap between a LEGO® Mindstorms® sensor and a breakout board.</p>

<h2 id="hardware-structure">Hardware Structure</h2>

<p>The datum boards are based on the Arduino Zero.  They use the same Atmel SAMD21G18 MCU used on the Zero.   Each datum board uses a standard micro B USB connector to connect to the host system.  The boards identify themselves as USB CDC devices and the host operating system creates a serial port for that board.  The serial port settings are 3000000, 8, N, 1.  Many terminal programs don’t actually care about the settings when a USB CDC device is being addressed but some terminal programs like PuTTY do care.</p>

<p>This means that each datum board can be used on nearly any platform or with any language that can read data from a serial port.  There are no libraries that need to be installed.  This and human readable data are two of the key features of the datum boards.</p>

<h2 id="parameter-hierarchy">Parameter Hierarchy</h2>

<p>Information about a particular board is stored in various parameters organized into several higher level categories.  The high level categories include device, config, options, and sensors.  An example of the structure is shown below.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"device"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
  </span><span class="s2">"config"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
  </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
  </span><span class="s2">"sensors"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The top level device category stores immutable information about a sensor.  Typical parameters stored here are manufacturer, product ID, version information, etc.  One of the parameters that will be included is a 64 bit unique user ID (UUID).  This acts as both the serial number for the board and as a means to identify this board at a system, household, or even global level.  The UUID is the same UUID used for generating MAC addresses in network systems.</p>

<p>The top level config category stores parameters that the user can change.  Typical values stored here are the report rate, automatic reporting, compact reports, etc.  Another parameter stored here is called ‘friendlyName’.  This particular parameter allows the user to pick their own name instead of using the UUID.  While it won’t necessarily be globally unique values like ‘left arm’ and ‘right arm’ are a lot more readable than a big string of numbers.</p>

<p>The options category contains information about the valid values for each of the config parameters.  If a range of values can be set the minimum and maximum value will be listed.  If there is a pick list of valid values they will be listed under the relevant parameter.  Text based parameters like ‘friendlyName’ will list the minimum and maximum length of the allowable string.</p>

<p>Having the information stored and categorized in this manner makes each datum board essentially self documenting.  While the information will always be available on other media and in different formats it is still stored right at hand, where it’s needed most.</p>

<p>The sensors category contains more detailed information about individual sensors on a board.  The information for each sensor is called out following the same device, config, and option format used in the top level categorization.  Items in the sensor category also include a ‘data’ field where the measurements taken from a particular sensor are stored.</p>

<h2 id="command-structure">Command Structure</h2>

<p>Commands are sent using a URI style syntax similar to that used for REST requests.  The response to every command is prefaced by an http response code indicating if a valid command was sent.  Commands must also be terminated with a carriage return and an optional line feed.</p>

<p>Requests for information start with a <code class="highlighter-rouge">get</code> command followed by the path to the information requested.  A command of <code class="highlighter-rouge">get /</code> will retrieve all the information in the hierarchy.  The command <code class="highlighter-rouge">get /device</code> will retrieve the parameters underneath the top level device category.  The command <code class="highlighter-rouge">get /device/manufacturer</code> will retrieve that specific parameter.</p>

<p>Information from sensors can be collected individually from each sensor but it can also be collected from all the sensors at the same time.  A command like <code class="highlighter-rouge">get /sensors/sensor1/device</code> would retrieve the device parameters from sensor1.  A command like<code class="highlighter-rouge">get /sensors/device</code> would retrieve the device parameters from all the sensors supported by that particular board.</p>

<p>Similarly config settings can be changed using either <code class="highlighter-rouge">set</code>, <code class="highlighter-rouge">put</code>, or <code class="highlighter-rouge">patch</code>.  Patch is the most technically correct but any of the terms work equally well.  A typical command to change the report rate would be <code class="highlighter-rouge">set /config?reportRate=10</code>.  This follows the URI style syntax of using a <code class="highlighter-rouge">?</code> to separate the resource category from the parameters being changed.  An equal signs is used to indicate the new value for a particular parameter.</p>

<p>Multiple commands may be sent with one set command as well.  Multiple commands are separated with the ‘&amp;’ symbol.  All the new settings must be in the same high level category.  The following command would set the report rate to 10 and enable automatic reporting:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">set</span><span class="w"> </span><span class="err">/config?reportRate=</span><span class="mi">10</span><span class="err">&amp;automaticReporting=</span><span class="kc">true</span><span class="err">.</span><span class="w">
</span></code></pre></div></div>

<p>Sensor config values may be set individually or en mass similar to the operation of the get command.  Changing the sample rate and data rate of all sensors on a board can be accomplished with the following command:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">set</span><span class="w"> </span><span class="err">/sensors/config?sampleRate=</span><span class="mi">10</span><span class="err">&amp;dataRate=</span><span class="mi">5</span><span class="w">
</span></code></pre></div></div>

<p>Commands can also be abbreviated.  This is a departure from the URI standard syntax but it greatly eases testing and debugging.  This is particularly true when commands are being entered manually.  Commands can be shortened to as few as one character.  Care must be taken with parameters that start with the same letters.  Enough characters must be provided to clearly distinguish which parameter is being changed or unexpected results could occur.</p>

<p>Example of how commands could be shortened are shown in the table below.</p>

<table>
  <thead>
    <tr>
      <th><strong>Full Command</strong></th>
      <th><strong>Abbreviated Command</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>get /config</td>
      <td>get /c</td>
    </tr>
  </tbody>
</table>

<h2 id="data-format">Data Format</h2>

<p>Taking measurements with one of the boards is a three step process.  The first step is collecting a sample from the sensor itself.  Samples are taken at the rate specified in the ‘sampleRate’ parameter.  This information is stored in a 16 element ring buffer.</p>

<p>The second step is transferring the measurement from the sample ring buffer to the data ring buffer.  The data ring buffer is also 16 elements.  The elements in the data ring buffer are populated at the rate specified in the ‘dataRate’ parameter.</p>

<p>Collecting samples and transferring them to the data buffer in this way allows various filters to be applied to the measurements as they pass through the buffers.  Each time an element in the data ring buffer is populated all the available samples in the sample ring buffer are processed through the filter method selected.</p>

<p>The filters currently available include none, mean, min, max, and RMS.  For example, if ten samples are available in the sample ring buffer and the filter type is set to mean the average value of those ten samples will be stored in the data ring buffer.  The min filter type would store the minimum of the ten values, the max filter type would store the maximum of the ten values, and the RMS filter would compute the root mean square value of the ten values.</p>

<p>The ‘none’ filter type just moves the most recent value from the sample ring buffer to the data ring buffer.  If the sample rate and data rate for a particular sensor were the same this would be the most appropriate filter to use.  A median filter is available in the list of filter types but it hasn’t been implemented yet.  Other filter types such as an IIR or FIR filter with custom coefficients may be implemented in the future.</p>

<p>The third step is reporting the data stored in the data ring buffer to the host system.  This happens at the rate specified in the ‘reportRate’ parameter.  All of the data available in the data ring buffer is processed and formatted for transmission to the host system.  Data is returned in a JSON packet with a report timestamp in the header and individual timestamps for each point of data collected.  An example of this from the datum-IMU board is shown below.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="mf">24042.9</span><span class="p">,</span><span class="w">
  </span><span class="s2">"accelerometer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"time"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">24042.45</span><span class="p">,</span><span class="w"> </span><span class="mf">24042.55</span><span class="p">,</span><span class="w"> </span><span class="mf">24042.65</span><span class="p">,</span><span class="w"> </span><span class="mf">24042.75</span><span class="p">,</span><span class="w"> </span><span class="mf">24042.85</span><span class="p">],</span><span class="w">
    </span><span class="s2">"x"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">0.82843</span><span class="p">,</span><span class="w"> </span><span class="mf">0.828125</span><span class="p">,</span><span class="w"> </span><span class="mf">0.828125</span><span class="p">,</span><span class="w"> </span><span class="mf">0.827454</span><span class="p">,</span><span class="w"> </span><span class="mf">0.828247</span><span class="p">],</span><span class="w">
    </span><span class="s2">"y"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">0.041138</span><span class="p">,</span><span class="w"> </span><span class="mf">0.041626</span><span class="p">,</span><span class="w"> </span><span class="mf">0.042053</span><span class="p">,</span><span class="w"> </span><span class="mf">0.042419</span><span class="p">,</span><span class="w"> </span><span class="mf">0.041443</span><span class="p">],</span><span class="w">
    </span><span class="s2">"z"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">-0.565735</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.566162</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.565735</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.565308</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.566895</span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"gyro"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"time"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">24042.45</span><span class="p">,</span><span class="w"> </span><span class="mf">24042.55</span><span class="p">,</span><span class="w"> </span><span class="mf">24042.65</span><span class="p">,</span><span class="w"> </span><span class="mf">24042.75</span><span class="p">,</span><span class="w"> </span><span class="mf">24042.85</span><span class="p">],</span><span class="w">
    </span><span class="s2">"x"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">0.006195</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006226</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006134</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006165</span><span class="p">,</span><span class="w"> </span><span class="mf">0.006165</span><span class="p">],</span><span class="w">
    </span><span class="s2">"y"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">0.003388</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003235</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003265</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003113</span><span class="p">,</span><span class="w"> </span><span class="mf">0.003235</span><span class="p">],</span><span class="w">
    </span><span class="s2">"z"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000153</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.000031</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.000031</span><span class="p">,</span><span class="w"> </span><span class="mf">0.000031</span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"magnetometer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"time"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">24042.46</span><span class="p">,</span><span class="w"> </span><span class="mf">24042.56</span><span class="p">,</span><span class="w"> </span><span class="mf">24042.66</span><span class="p">,</span><span class="w"> </span><span class="mf">24042.76</span><span class="p">,</span><span class="w"> </span><span class="mf">24042.86</span><span class="p">],</span><span class="w">
    </span><span class="s2">"x"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">0.126011</span><span class="p">,</span><span class="w"> </span><span class="mf">0.125736</span><span class="p">,</span><span class="w"> </span><span class="mf">0.12653</span><span class="p">,</span><span class="w"> </span><span class="mf">0.125889</span><span class="p">,</span><span class="w"> </span><span class="mf">0.126652</span><span class="p">],</span><span class="w">
    </span><span class="s2">"y"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">0.041597</span><span class="p">,</span><span class="w"> </span><span class="mf">0.040956</span><span class="p">,</span><span class="w"> </span><span class="mf">0.041963</span><span class="p">,</span><span class="w"> </span><span class="mf">0.040864</span><span class="p">,</span><span class="w"> </span><span class="mf">0.042116</span><span class="p">],</span><span class="w">
    </span><span class="s2">"z"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">0.068026</span><span class="p">,</span><span class="w"> </span><span class="mf">0.068056</span><span class="p">,</span><span class="w"> </span><span class="mf">0.069063</span><span class="p">,</span><span class="w"> </span><span class="mf">0.070071</span><span class="p">,</span><span class="w"> </span><span class="mf">0.070254</span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="prototypes">Prototypes</h2>

<p>There are four boards coming soon, datum-Distance, datum-IMU, datum-Light, and datum-Weather.  Each board features a different chip using their own unique communication interface and language.  They are meant to showcase the capabilities of each chip while highlighting the common command structure and format for reporting the information collected.</p>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2018-06-04">June 04, 2018</time></p>
        
      </footer>

      

      
    </div>

    
  </article>

  
  
</div>
    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->

        <div class="page__footer-follow">
  <ul class="social-icons">
    <!--
    
      <li><strong>Follow:</strong></li>
    
  -->
    
    
    
    
    
    <!--
    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    -->
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 J&J Studios. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script>








  </body>
</html>